# Math Tutor Telegram Bot - ×¡×§×™×¨×ª ×¤×¨×•×™×™×§×˜ ××œ××” ğŸ“šğŸ¤–

## ××” ×–×” ×”×¤×¨×•×™×™×§×˜?

×‘×•×˜ ×˜×œ×’×¨× ×—×›× ×œ×ª×™××•× ×©×™×¢×•×¨×™ ××ª××˜×™×§×” ×¤×¨×˜×™×™× ×¢× ×™×›×•×œ×•×ª AI ××ª×§×“××•×ª. ×”×‘×•×˜ ××‘×™×Ÿ ×©×¤×” ×˜×‘×¢×™×ª ×‘×¢×‘×¨×™×ª ×•×‘×× ×’×œ×™×ª ×•×××¤×©×¨ ×œ×ª×œ××™×“×™× ×œ×ª×× ×©×™×¢×•×¨×™× ×‘×§×œ×•×ª.

## ğŸ¯ ×ª×›×•× ×•×ª ×¢×™×§×¨×™×•×ª

### ğŸ¤– AI-Powered ×¢×™×‘×•×“ ×©×¤×” ×˜×‘×¢×™×ª
- ×”×‘× ×ª ×‘×§×©×•×ª ×‘×¢×‘×¨×™×ª: "×× ×™ ×¨×•×¦×” ×©×™×¢×•×¨ ××—×¨ ×‘×©×¢×” 3"
- ×–×™×”×•×™ ×›×•×•× ×•×ª: ×ª×™××•×, ×‘×™×˜×•×œ, ×©×™× ×•×™ ×–××Ÿ
- ×—×™×œ×•×¥ ×¤×¨×˜×™× ××•×˜×•××˜×™: ×ª××¨×™×›×™×, ×©×¢×•×ª, × ×•×©××™×

### ğŸ“… × ×™×”×•×œ ×œ×•×— ×–×× ×™×
- ××™× ×˜×’×¨×¦×™×” ×¢× Google Calendar
- ×‘×“×™×§×ª ×–××™× ×•×ª ×‘×–××Ÿ ×××ª
- ×¨×©×™××ª ×”××ª× ×” ×œ×–×× ×™× ×ª×¤×•×¡×™×
- ×ª×–×›×•×¨×•×ª ××•×˜×•××˜×™×•×ª

### ğŸ“ × ×™×”×•×œ ×ª×œ××™×“×™× ××ª×§×“×
- ×¤×¨×•×¤×™×œ×™× ××™×©×™×™×
- ××¢×§×‘ ××—×¨ ×”×ª×§×“××•×ª
- ×”×™×¡×˜×•×¨×™×™×ª ×©×™×¢×•×¨×™×
- ×”×¢×“×¤×•×ª ××™×©×™×•×ª

### ğŸ”” ××¢×¨×›×ª ×”×ª×¨××•×ª
- ×ª×–×›×•×¨×•×ª ×œ×¤× ×™ ×©×™×¢×•×¨
- ××™×©×•×¨×™ ×ª×™××•×
- ×¢×“×›×•× ×™× ×¢×œ ×©×™× ×•×™×™×
- ×”×ª×¨××•×ª ×¨×©×™××ª ×”××ª× ×”

## ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×” ×˜×›× ×™×ª

### ××‘× ×” ×ª×™×§×™×•×ª
```
teltgrambot/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ ai/             # ××•×“×•×œ×™ AI (GPT-4, LangChain)
â”‚   â”‚   â””â”€â”€ scheduler.js
â”‚   â”œâ”€â”€ bot/            # ×œ×•×’×™×§×ª ×”×‘×•×˜
â”‚   â”‚   â”œâ”€â”€ commands/   # ×¤×§×•×“×•×ª ×‘×•×˜
â”‚   â”‚   â””â”€â”€ handlers/   # ××˜×¤×œ×™ ×”×•×“×¢×•×ª
â”‚   â”œâ”€â”€ config/         # ×”×’×“×¨×•×ª ×•×”×§×©×¨×™ DB
â”‚   â”œâ”€â”€ models/         # ××•×“×œ×™ × ×ª×•× ×™× (Sequelize)
â”‚   â”œâ”€â”€ services/       # ×©×™×¨×•×ª×™× (×œ×•×— ×©× ×”, ×”×ª×¨××•×ª)
â”‚   â”œâ”€â”€ routes/         # API endpoints
â”‚   â””â”€â”€ utils/          # ×›×œ×™ ×¢×–×¨ ×•×œ×•×’×™×
â”œâ”€â”€ data/              # ×§×‘×¦×™ × ×ª×•× ×™×
â”œâ”€â”€ logs/              # ×§×‘×¦×™ ×œ×•×’
â””â”€â”€ scripts/           # ×¡×§×¨×™×¤×˜×™ ×”×ª×§× ×”
```

### ×˜×›× ×•×œ×•×’×™×•×ª ×‘×©×™××•×©

#### Backend
- **Node.js** - ×¤×œ×˜×¤×•×¨××”
- **Express.js** - ×©×¨×ª web
- **Telegraf** - ××¡×’×¨×ª ×¢×‘×•×“×” ×œ×‘×•×˜ ×˜×œ×’×¨×
- **Sequelize + SQLite** - ××¡×“ × ×ª×•× ×™×
- **Winston** - ×œ×•×’×™×

#### AI & ML
- **OpenAI GPT-4 Turbo** - ×¢×™×‘×•×“ ×©×¤×” ×˜×‘×¢×™×ª
- **LangChain** - ××¡×’×¨×ª ×¢×‘×•×“×” ×¢× LLM
- **Chrono-node** - ×–×™×”×•×™ ×ª××¨×™×›×™× ×•×©×¢×•×ª
- **Zod** - ×•×œ×™×“×¦×™×™×ª × ×ª×•× ×™×

#### ××™× ×˜×’×¨×¦×™×•×ª
- **Google Calendar API** - × ×™×”×•×œ ×œ×•×— ×–×× ×™×
- **Moment.js + Timezone** - ×¢×™×‘×•×“ ×–×× ×™×
- **Render** - ×¤×œ×˜×¤×•×¨××ª deployment

## ğŸ“Š ××¡×“ ×”× ×ª×•× ×™×

### ×˜×‘×œ××•×ª ×¢×™×§×¨×™×•×ª

#### Students (×ª×œ××™×“×™×)
```sql
- id, telegram_id, username, first_name, last_name
- phone, email, timezone, language
- total_lessons_booked, total_lessons_completed
- status, preferences, created_at, updated_at
```

#### Lessons (×©×™×¢×•×¨×™×)
```sql
- id, student_id, start_time, end_time
- subject, topic, difficulty_level, lesson_type
- status, price, currency, meeting_link
- teacher_notes, student_feedback, created_at
```

#### TeacherAvailability (×–××™× ×•×ª ××•×¨×”)
```sql
- id, schedule_type, day_of_week, start_time, end_time
- is_available, priority, max_lessons_per_slot
- buffer_before, buffer_after, status
```

#### NotificationLog (×œ×•×’ ×”×ª×¨××•×ª)
```sql
- id, student_id, lesson_id, notification_type
- content, status, sent_at, read_at
```

#### Waitlist (×¨×©×™××ª ×”××ª× ×”)
```sql
- id, student_id, requested_start_time, requested_end_time
- priority, status, created_at, notified_at
```

## ğŸ”„ ×–×¨×™××ª ×¢×‘×•×“×”

### ×ª×™××•× ×©×™×¢×•×¨ ×—×“×©
1. **×§×‘×œ×ª ×”×•×“×¢×”** - ×ª×œ××™×“ ×©×•×œ×— ×‘×§×©×” ×‘×©×¤×” ×˜×‘×¢×™×ª
2. **×¢×™×‘×•×“ AI** - GPT-4 ×× ×ª×— ×•××—×œ×¥ ×¤×¨×˜×™×
3. **×‘×“×™×§×ª ×–××™× ×•×ª** - ×”××¢×¨×›×ª ×‘×•×“×§×ª ×œ×•×— ×–×× ×™×
4. **×ª×¦×•×’×ª ××¤×©×¨×•×™×•×ª** - ××¦×™×’×” ×–×× ×™× ×–××™× ×™×
5. **××™×©×•×¨ ×ª×™××•×** - ×ª×œ××™×“ ×××©×¨
6. **×¢×“×›×•×Ÿ ×œ×•×— ×–×× ×™×** - Google Calendar + DB
7. **×©×œ×™×—×ª ××™×©×•×¨** - ×”×ª×¨××” ×œ×ª×œ××™×“

### ×˜×™×¤×•×œ ×‘×”×•×“×¢×” ×¨×’×™×œ×”
```javascript
// src/bot/handlers/messageHandler.js
const message = ctx.message.text;
const aiResult = await aiScheduler.processSchedulingRequest(message, student);

switch(aiResult.intent) {
  case 'book_lesson':
    await handleBookingRequest(ctx, aiResult);
    break;
  case 'cancel_lesson':
    await handleCancellation(ctx, aiResult);
    break;
  // ... ×¢×•×“ ××§×¨×™×
}
```

## ğŸ¤– ×”-AI Agent ×‘×¤×™×¨×•×˜

### ××™×š ×–×” ×¢×•×‘×“?
```javascript
// ×“×•×’××” ×œ×¢×™×‘×•×“ ×‘×§×©×”
const result = await aiScheduler.processSchedulingRequest(
  "×× ×™ ×¨×•×¦×” ×©×™×¢×•×¨ ××œ×’×‘×¨×” ×‘×™×•× ×©×™×©×™ ××—×¨×™ 3",
  studentProfile
);

// ×ª×•×¦××”:
{
  "intent": "book_lesson",
  "confidence": 0.92,
  "datetime_preferences": [{
    "date": "2024-01-19", 
    "time": "15:00",
    "flexibility": "preferred"
  }],
  "lesson_details": {
    "subject": "math",
    "topic": "algebra"
  }
}
```

### ×¨××•×ª ×‘×™×˜×—×•×Ÿ
- **0.9-1.0** - ×–×™×”×•×™ ××“×•×™×§, ×¤×¢×•×œ×” ×™×©×™×¨×”
- **0.7-0.8** - ×–×™×”×•×™ ×˜×•×‘, ×”×¦×’×ª ××¤×©×¨×•×™×•×ª
- **0.5-0.6** - ×–×™×”×•×™ ×—×œ×§×™, ×‘×§×©×ª ×”×‘×”×¨×”
- **0-0.4** - ×œ× ×”×‘×™×Ÿ, ××¢× ×” ×›×œ×œ×™

## ğŸš€ Deployment ×•-CI/CD

### Render Platform
- **×©×¨×ª production**: https://math-tutor-bot.onrender.com
- **Auto-deployment** ×-main branch
- **Environment variables** ××•×’×“×¨×™× ×‘-Render
- **Health checks** ××•×˜×•××˜×™×™×

### GitHub Actions (.github/workflows/deploy.yml)
```yaml
1. Test (Node 18.x, 20.x)
   - npm ci
   - npm run lint
   - npm test
   
2. Deploy to Render
   - Auto-trigger on push to main
   - Webhook verification
   
3. Health Check
   - Service availability
   - Bot response test
```

### ×”×’×“×¨×•×ª Environment
```
# Required
TELEGRAM_BOT_TOKEN=your_bot_token
OPENAI_API_KEY=your_openai_key

# Optional
NODE_ENV=production
PORT=3000
WEBHOOK_URL=https://math-tutor-bot.onrender.com
DATABASE_URL=sqlite:./data/database.sqlite
```

## ğŸ“ ×”×’×“×¨×•×ª ××¨×›×–×™×•×ª

### src/config/settings.js
```javascript
module.exports = {
  // ××™×“×¢ ××•×¨×”
  teacher: {
    name: "Math Tutor",
    timezone: "Asia/Jerusalem",
    email: "tutor@example.com"
  },
  
  // ×©×¢×•×ª ×¤×¢×™×œ×•×ª
  businessHours: {
    start: "08:00",
    end: "20:00", 
    days: ["sunday", "monday", "tuesday", "wednesday", "thursday"]
  },
  
  // ×”×’×“×¨×•×ª ×©×™×¢×•×¨×™×
  lessons: {
    defaultDuration: 60,
    bufferTime: 15,
    maxAdvanceBooking: 30
  },
  
  // ×”×’×“×¨×•×ª AI
  ai: {
    model: "gpt-4-turbo-preview",
    temperature: 0.7,
    maxTokens: 500
  }
};
```

## ğŸ”§ ×¤×§×•×“×•×ª ×¤×™×ª×•×—

### ×”×ª×§× ×” ××§×•××™×ª
```bash
npm install
cp env.example .env
# ×¢×¨×•×š .env ×¢× ×”×˜×•×§× ×™× ×©×œ×š
npm run setup
npm start
```

### ×¤×§×•×“×•×ª ×–××™× ×•×ª
```bash
npm start          # ×”×¤×¢×œ×ª ×”×‘×•×˜
npm run dev        # ××¦×‘ ×¤×™×ª×•×— ×¢× nodemon
npm test           # ×”×¨×¦×ª ×‘×“×™×§×•×ª
npm run setup      # ×”×’×“×¨×ª ××¡×“ × ×ª×•× ×™×
npm run lint       # ×‘×“×™×§×ª ×§×•×“
```

## ğŸ“Š × ×™×˜×•×¨ ×•×œ×•×’×™×

### Winston Logging
```javascript
logger.botLog('user_action', userId, username, 'Started bot');
logger.aiLog('processing_request', message, result);
logger.error('Database error:', error);
```

### ×¡×•×’×™ ×œ×•×’×™×
- **INFO** - ×¤×¢×•×œ×•×ª ×¨×’×™×œ×•×ª
- **WARN** - ×”×ª×¨××•×ª
- **ERROR** - ×©×’×™××•×ª
- **DEBUG** - ××™×“×¢ ×¤×™×ª×•×—

### ××™×§×•× ×œ×•×’×™×
- **Development**: ×§×•× ×¡×•×œ + logs/
- **Production**: Render logs

## ğŸ” ××‘×˜×—×”

### ××™××•×ª Webhook
```javascript
// Telegram webhook validation
const isValid = validateTelegramWebhook(req.body, secretToken);
```

### ×”×’× ×ª API
- Environment variables ×œ×˜×•×§× ×™× ×¨×’×™×©×™×
- HTTPS ×‘×œ×‘×“ ×‘production
- Rate limiting ×¢×œ requests

## ğŸ® ×“×•×’×××•×ª ×©×™××•×©

### ×ª×™××•× ×‘×©×¤×” ×˜×‘×¢×™×ª
```
×ª×œ××™×“: "×× ×™ ×¨×•×¦×” ×©×™×¢×•×¨ ××ª××˜×™×§×” ××—×¨ ××—×¨ ×”×¦×”×¨×™×™×"
×‘×•×˜: "ğŸ“ × ××¦××• ×–×× ×™× ×–××™× ×™× ××—×¨:
      â€¢ 14:00-15:00 âœ…
      â€¢ 16:00-17:00 âœ…
      â€¢ 17:30-18:30 âœ…
      ××™×–×” ×–××Ÿ ××ª××™× ×œ×š?"
```

### ×‘×™×˜×•×œ ×©×™×¢×•×¨
```
×ª×œ××™×“: "×¦×¨×™×š ×œ×‘×˜×œ ××ª ×”×©×™×¢×•×¨ ×‘×™×•× ×¨×‘×™×¢×™"
×‘×•×˜: "ğŸ” ××¦××ª×™ ×©×™×¢×•×¨ ×‘×¨×‘×™×¢×™ 15/1 ×‘×©×¢×” 16:00
      ×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×‘×˜×œ? âš ï¸"
```

### ×‘×“×™×§×ª ×–××™× ×•×ª
```
×ª×œ××™×“: "××ª×™ ×™×© ×–×× ×™× ×¤× ×•×™×™× ×”×©×‘×•×¢?"
×‘×•×˜: "ğŸ“… ×–×× ×™× ×¤× ×•×™×™× ×”×©×‘×•×¢:
      ×™×•× ×‘×³ 13/1: 14:00, 16:00, 18:00
      ×™×•× ×’×³ 14/1: 15:00, 17:00
      ×™×•× ×”×³ 16/1: 14:00, 16:30"
```

## ğŸš€ ×¤×™×¦'×¨×™× ×¢×ª×™×“×™×™×

### ×‘×ª×›× ×•×Ÿ
- [ ] ×ª×©×œ×•××™× ××•× ×œ×™×™×Ÿ
- [ ] ×•×™×“×™××• ×§×•×œ ×‘××”×œ×š ×”×©×™×¢×•×¨  
- [ ] ××¢×¨×›×ª ×¦×™×•× ×™× ×•×”×¢×¨×›×•×ª
- [ ] ×‘×•×˜ ×œ××•×¨×™× (×××©×§ × ×™×”×•×œ)
- [ ] ×ª××™×›×” ×‘×©×¤×•×ª × ×•×¡×¤×•×ª
- [ ] ××™× ×˜×’×¨×¦×™×” ×¢× Zoom/Teams

### ×©×™×¤×•×¨×™× ×˜×›× ×™×™×
- [ ] Redis ×œ×§××©
- [ ] PostgreSQL ×‘××§×•× SQLite
- [ ] Docker containers
- [ ] Kubernetes deployment
- [ ] ×’×¨×¤× ×” + PromQL ×œ××˜×¨×™×§×¡

## ğŸ†˜ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª × ×¤×•×¦×•×ª

### ×”×‘×•×˜ ×œ× ××’×™×‘
1. ×‘×“×•×§ webhook ×‘-Render logs
2. ×•×“× ×©-TELEGRAM_BOT_TOKEN ×ª×§×™×Ÿ
3. ×‘×“×•×§ ×©-NODE_ENV=production

### ×©×’×™××•×ª AI
1. ×‘×“×•×§ OPENAI_API_KEY
2. ×•×“× ×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜
3. ×‘×“×•×§ ××›×¡×ª OpenAI

### ×‘×¢×™×•×ª ××¡×“ × ×ª×•× ×™×
1. ×”×¨×¥ `npm run setup`
2. ×‘×“×•×§ ×”×¨×©××•×ª ×§×‘×¦×™×
3. ×•×“× ×©×˜×‘×œ××•×ª × ×•×¦×¨×•

## ğŸ“ ×ª××™×›×”

- **GitHub Issues**: ×œ×‘××’×™× ×•×‘×§×©×•×ª ×¤×™×¦'×¨×™×
- **Logs**: ×‘×“×•×§ ×‘-Render dashboard
- **Documentation**: ×§×¨× ××ª DEPLOYMENT.md

---

**ğŸ‰ ×”×¤×¨×•×™×™×§×˜ ××©×œ×‘ ×˜×›× ×•×œ×•×’×™×•×ª ××ª×§×“××•×ª ×›×“×™ ×œ×™×¦×•×¨ ×—×•×•×™×™×ª ×ª×™××•× ×©×™×¢×•×¨×™× ×—×œ×§×” ×•××™× ×˜×œ×™×’× ×˜×™×ª!** 